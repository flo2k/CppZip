version: '{build}'

# Build worker image (VM template)
os: Visual Studio 2015

# specify custom environment variables
environment:
    MSVC_DEFAULT_OPTIONS: ON
    BOOST_ROOT: C:\Libraries\boost_1_62_0
    BOOST_LIBRARYDIR: C:\Libraries\boost_1_62_0\lib32-msvc-14.0
    ZLIB_DIR: C:\projects\zlib
    DOXYGEN_DIR: C:\projects\doxygen

init:
    - cmd: cmake --version
    - cmd: msbuild /version

install:
    - nuget install zlib -outputdirectory "%ZLIB_DIR%"
    - dir "%ZLIB_DIR%"
    - dir "%ZLIB_DIR%\zlib.1.2.8.8"
    - dir "%ZLIB_DIR%\zlib.1.2.8.8\zlib.1.2.8.8.nupkg"
    - dir "%ZLIB_DIR%\zlib.v140.windesktop.msvcstl.dyn.rt-dyn.1.2.8.8"
    - dir "%ZLIB_DIR%\zlib.v140.windesktop.msvcstl.dyn.rt-dyn.1.2.8.8\build"
    - dir "%ZLIB_DIR%\zlib.v140.windesktop.msvcstl.dyn.rt-dyn.1.2.8.8\lib"
    - dir "%ZLIB_DIR%\zlib.v140.windesktop.msvcstl.dyn.rt-dyn.1.2.8.8\build\native"
    - dir "%ZLIB_DIR%\zlib.v140.windesktop.msvcstl.dyn.rt-dyn.1.2.8.8\lib\native"
    - tree /A /F "%ZLIB_DIR%"
    - nuget install cppunit -outputdirectory "C:\projects\cppunit"
    - nuget install Doxygen -outputdirectory "%DOXYGEN_DIR%"

before_build:
    - md build
    - cmake -H. -Bbuild
        -DBOOST_ROOT="%BOOST_ROOT%" -DBOOST_LIBRARYDIR="%BOOST_LIBRARYDIR%"
        -DDOXYGEN_EXECUTABLE="%DOXYGEN_DIR%"

        #-DZLIB_INCLUDE_DIR="%ZLIB_DIR%" -DZLIB_LIBRARY="%ZLIB_DIR%"

build_script:
    - cmake --build build --config Debug
